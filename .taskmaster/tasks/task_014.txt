# Task ID: 14
# Title: Implement Refinement System
# Status: pending
# Dependencies: 6, 7, 13
# Priority: medium
# Description: Create adapters for refining generated tests based on pytest failures and other issues.
# Details:
1. Create refine/manager.py:
   - Categorize failures (import errors, assertion mismatches, fixture/mocks)
   - Select appropriate refinement strategy
   - Cap iterations and total time
   - Stop on no-change
   - Safely apply updates
   - Rerun pytest to verify fixes
2. Implement refinement strategies:
   - refine/strategies/import_fix.py
   - refine/strategies/assertion_fix.py
   - refine/strategies/fixture_fix.py
3. Create payload builder in application layer:
   - Include failures, artifacts, repo context
   - Add last run command, tests written, git metadata
   - Analyze and include pattern information
4. Implement safe apply closure and rerun closure

# Test Strategy:
Unit tests for failure categorization with sample pytest outputs. Test each refinement strategy with specific failure types. Verify iteration caps and time limits work correctly. Test safe apply with various test files.
